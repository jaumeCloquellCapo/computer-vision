% Leemos la imagen
castillo_orig = imread('castillo.pgm');
castillo_vac = imread('Castillo_oculto2bits.pgm');

% desencriptar
A = castillo_vac;
figure, subplot(2,2,1);imshow(castillo_vac);title('castillo con imagen oculta');
B=bitget(A,1); subplot(2,2,2);imshow(logical(B));title('Primer imagen '); %obtenos el primer bit
B=bitget(A,2); 
% y lo pasamos a double ahora
vacas_3_niveles_gris = double(B);

% Calculamos el m?nimo y m?ximo
minimo = min(min(vacas_3_niveles_gris));
maximo = max(max(vacas_3_niveles_gris));

% normalizamos la imagen -> con esto conseguimos la imagen de las vacas con
% los 3 niveles de gris
vacas_3_niveles_gris = (vacas_3_niveles_gris - minimo) / (maximo - minimo);



subplot(2,2,3);imshow(logical(B));title('Segunda imagen'); %obtenos el segundo bit
% encriptar


% Para recuperar la imagen original encriptada dentro del castillp desplazamos el
% bit más significativo a la derecha para luego desplzarlo a la izquierda
% y sumamos los dos niveles de gris 
B = bitshift(castillo_orig,-1);
B = bitshift(B,1);
B = B + bitand(castillo_vac,1);
subplot(2,2,4);imshow(B);title('Imagen encriptada');

